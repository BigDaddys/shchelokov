<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8">
    <title>Изучение JavaScript</title>
    <style>
      * { padding: 0; margin: 0; }
      body { font-family: sans-serif; padding: 40px; }
      table { border-top: 1px solid #ccc; border-left: 1px solid #ccc; }
      table td { border-right: 1px solid #ccc; border-bottom: 1px solid #ccc; vertical-align: middle; font-size: 14px; padding: 10px 20px;}
      table td:first-child { text-align: center; }
      button { padding: 5px 10px; border: none; background: #9b59b6; color: #fff; cursor: pointer; border: 1px solid transparent; }
      button:hover { border-color: #9b59b6; color: #9b59b6; background: transparent; }
      label { font-size: 12px; }
      label input[type="checkbox"] { display: inline-block; vertical-align: middle; margin-right: 5px; }
      #resultPassword { text-align: left; }
    </style>
  </head>

  <script>

    // Добавить событие к кнопке
    let addEventButton = function addEventButton(id, func) {
      document.getElementById(id).addEventListener('click', func, false);
    };

    // Шар Судьбы
    let initBall = function initBall() {
      const PHRASES = [
        "Звучит неплохо",
        "Да, это определенно надо сделать",
        "Не думаю, что это хорошая идея",
        "Может, не сегодня?",
        "Компьютер говорит нет"
      ];

      let outputPhareseResult = document.getElementById('resultPhraseBall');
      let question = prompt("Введите вопрос", "");

      if (question) {
        outputPhareseResult.innerHTML = question + "?&nbsp;<b>Ответ:</b>&nbsp;" + PHRASES[Math.floor(Math.random() * PHRASES.length)];
      } else {
        return;
      }
    };

    // Генератор дразнилок
    let generateInsult = function generateInsult() {
      const RANDOM_BODY_PARTS = ['глаз', 'нос', 'рот', 'череп'];
      const RANDOM_ADJECTIVES = ['вонючий', 'унылый', 'дурацкий'];
      const RANDOM_BODY_PARTS_ANIMALS = ['лапа', 'хвост', 'пасть', 'морда', 'крыло'];
      const RANDOM_ANIMALS = ['мухи', 'выдры', 'мартышки', 'крысы'];

      let outputInsult = document.getElementById('resultInsult');

      let getRandomWord = function getRandomWord(arrayName) {
        return arrayName[Math.floor(Math.random() * arrayName.length)];
      };

      outputInsult.innerHTML = [
        "У тебя",
        getRandomWord(RANDOM_BODY_PARTS),
        "ещё более",
        getRandomWord(RANDOM_ADJECTIVES) + ',',
        "чем",
        getRandomWord(RANDOM_BODY_PARTS_ANIMALS),
        "у",
        getRandomWord(RANDOM_ANIMALS) + "!"
      ].join(" ");
    };

    // Генератор пароля
    let generatePassword = function generatePassword() {
      const ALPHABET = "abcdefghijklmnopqrstuvwxyz";
      const DIGITALS = "0123456789";
      const SYMBOLS = "!@#$%^&*()_+-={}[]:;|?<>/\"'~";

      let lettersString = ALPHABET;
      let alphabetUpper = ALPHABET.toUpperCase();
      let genString = "";
      let len = prompt("Длина пароля", "7");
      let outputPassword = document.getElementById('resultPassword');

      let getCheckedStatus = function getCheckedStatus(id) {
        let status = document.getElementById(id).checked;
        return status;
      };

      if (getCheckedStatus('selectAlpabetUpper')) {
        lettersString += alphabetUpper;
      }

      if (getCheckedStatus('selectDigitals')) {
        lettersString += DIGITALS;
      }

      if (getCheckedStatus('selectSymbols')) {
        lettersString += SYMBOLS;
      }

      for (let i = 0; i < len; i++) {
        genString += lettersString[Math.floor(Math.random() * lettersString.length)];
      }

      outputPassword.innerHTML = genString;
    };

    // Хакерский язык
    let hackLang = function hackLang() {
      let inputString = prompt("Введите текст", "");
      let outputString = "";
      let outputHack = document.getElementById('resultHack');

      if (inputString) {
        for (let i = 0; i < inputString.length; i++) {
          if (inputString[i] === "A" || inputString[i] === "a") {
            outputString += "4";
          } else if(inputString[i] === "E" || inputString[i] === "e") {
            outputString += "3";
          } else if(inputString[i] === "I" || inputString[i] === "i") {
            outputString += "1";
          } else if(inputString[i] === "O" || inputString[i] === "o") {
            outputString += "0";
          } else {
            outputString += inputString[i];
          }
        }
      } else {
        return;
      }

      outputHack.innerHTML = outputString;
    };

    // Игра Виселица
    let gameViselica = function gameViselica() {
      const WORDS = [
        "ателье",
        "стрела",
        "болото",
        "лекарь",
        "ворота",
        "сказка",
        "правда",
        "карась",
        "сердце",
        "голова",
        "дерево",
        "дорога"
      ];

      let cnvs = document.getElementById('viselicaCanvas');
      let ctx = cnvs.getContext('2d');

      //--- Выбор случайного слова
      let pickWord = function pickWord(array) {
        return array[Math.floor(Math.random() * array.length)];
      };

      //--- Создание массива со скрытыми буквами
      let setupAnswerArray = function setupAnswerArray(word) {
        let createArray = [];

        for (let i = 0; i < word.length; i++) {
          createArray[i] = "_";
        }

        return createArray;
      };

      //--- Обновление результатов игры после ввода буквы игроком
      let updateGameState = function updateGameState(letter, word, array) {
        let countLetters = 0;

        for (let j = 0; j < word.length; j++) {
          if (word[j] === letter && array[j] === '_') {
            array[j] = letter;
            countLetters++;
          }
        }

        return countLetters;
      };

      //--- Рисование человечка
      let drawSegment = function drawSegment(incorrectGuesses) {
        ctx.lineWidth = 2;

        if (incorrectGuesses === 0) {
          ctx.strokeRect(235,100,30,30);
        } else if (incorrectGuesses === 1) {
          ctx.beginPath();
          ctx.moveTo(250,131);
          ctx.lineTo(250,191);
          ctx.stroke();
        } else if (incorrectGuesses === 2) {
          ctx.beginPath();
          ctx.moveTo(250,151);
          ctx.lineTo(225,141);
          ctx.stroke();
        } else if (incorrectGuesses === 3) {
          ctx.beginPath();
          ctx.moveTo(250,151);
          ctx.lineTo(275,141);
          ctx.stroke();
        } else if (incorrectGuesses === 4) {
          ctx.beginPath();
          ctx.moveTo(250,191);
          ctx.lineTo(225,221);
          ctx.stroke();
        } else if (incorrectGuesses === 5) {
          ctx.beginPath();
          ctx.moveTo(250,191);
          ctx.lineTo(275,221);
          ctx.stroke();
        }
      };

      let randomWord = pickWord(WORDS);
      let answerArray = setupAnswerArray(randomWord);
      let remainingLetters = randomWord.length;
      let countSteps = randomWord.length + 5;
      let outputContainer = document.getElementById('viselicaWord');
      let guess = '';
      let correctGuesses = 0;
      let incorrectGuesses = 0;

      while (remainingLetters > 0 && countSteps !== 0) {
        alert(answerArray.join(" "));

        guess = prompt('Угадайте букву (Количество попыток: ' + countSteps + ')', '');

        if (guess === null) {
          break;
        } else if (guess.length !== 1) {
          alert('Введите только одну букву!');
        } else {
          guess = guess.toLowerCase();
          correctGuesses = updateGameState(guess, randomWord, answerArray);
          remainingLetters -= correctGuesses;

          if (correctGuesses === 0) {
            drawSegment(incorrectGuesses);
            incorrectGuesses++;
          }

          countSteps--;
        }
      }

      outputContainer.innerHTML = 'Угадано: <b>' + answerArray.join(" ") + '</b>';
    };

    // Сравнение массивов
    let arraysСompare = function arraysСompare() {
      let arrayOne = prompt('Введите первую последовательность через запятую', '');
      let arrayTwo = prompt('Введите вторую последовательность через запятую', '');
      let outputArraysСompareResult = document.getElementById('arraysСompareResult');

      if (arrayOne === null || arrayTwo === null) {
        return;
      }

      arrayOne = arrayOne.split(',');
      arrayTwo = arrayTwo.split(',');

      if (arrayOne.length !== arrayTwo.length) {
        outputArraysСompareResult.innerHTML = "Разная длина массивов";
        return;
      }

      for (let i = 0; i < arrayOne.length; i++) {
        if (arrayOne[i] !== arrayTwo[i]) {
          outputArraysСompareResult.innerHTML = "Массивы не равны";
          return;
        }
      }

      outputArraysСompareResult.innerHTML = "Массивы равны";
    };

    // Игра Найди клад!
    let findInMap = function findInMap() {
      let outputfindInMapResult = document.getElementById('findInMapResult');
      let widthImg = parseInt(document.getElementById('findInMapImg').getAttribute('width'), 10);
      let heightImg = parseInt(document.getElementById('findInMapImg').getAttribute('height'), 10);
      let clicks = 20;
      let target = {
        x: getRandomNumber(widthImg),
        y: getRandomNumber(heightImg)
      }

      outputfindInMapResult.innerHTML = "<b>Кликни на карте</b>";

      document.getElementById('findInMapImg').addEventListener('click', function (e) {
        if (clicks > 0) {
          let distance = getDistance(e, target);

          if (distance < 8) {
            outputfindInMapResult.innerHTML = "<b>Клад найден</b>. Сделано кликов: " + clicks;
            return;
          } else {
            outputfindInMapResult.innerHTML = getDistanceHint(distance) + " Осталось кликов: " + clicks;
          }
        } else {
          outputfindInMapResult.innerHTML = "<b>Конец игры. Превышено количество кликов</b>";
          return;
        }

        clicks--;
      }, false);

      //--- Получение случайного числа
      function getRandomNumber(size) {
        return Math.floor(Math.random() * size);
      };

      //--- Вычисление расстояния от клика до точки (клада)
      function getDistance(e, target) {
        let diffX = e.offsetX - target.x;
        let diffY = e.offsetY - target.y;
        return Math.floor(Math.sqrt((diffX * diffX) + (diffY * diffY)));
      }

      //--- Сообщение о близости к цели
      function getDistanceHint(distance) {
        if (distance < 10) {
          return "Обожжешься!";
        } else if (distance < 20) {
          return "Очень горячо.";
        } else if (distance < 40) {
          return "Горячо.";
        } else if (distance < 80) {
          return "Тепло.";
        } else if (distance < 160) {
          return "Холодно.";
        } else if (distance < 320) {
          return "Очень холодно.";
        } else if (distance < 400) {
          return "Очень-очень холодно.";
        } else {
          return "Замерзнешь!";
        }
      }
    };

    // Игра "Гонка на автомобилях"
    let carRacing = function carRacing() {
      let road = document.getElementById('carRacingRoad');

      road.style.position = "relative";
      road.style.overflow = "hidden";
      road.style.width = "500px";
      road.style.height = "500px";

      //--- Конструктор Car
      let Car = function (x,y,speed) {
        this.x = x;
        this.y = y;
        this.speed = speed;
        this.draw();
      };

      //--- Добавление изображения авто в произвольное место
      Car.prototype.draw = function () {
        this.carElement = document.createElement('img');
        this.carElement.src = "http://nostarch.com/images/car.png";
        this.carElement.alt = "";
        this.carElement.width = "70";
        this.carElement.style.position = "absolute";
        this.carElement.style["left"] = this.x + 'px';
        this.carElement.style["top"] = this.y + 'px';

        road.appendChild(this.carElement);
      };

      Car.prototype.moveRight = function (step) {
        this.x += step ? step : this.speed;
        this.carElement.style["left"] = this.x + 'px';
      };

      Car.prototype.moveLeft = function (step) {
        this.x -= step ? step : this.speed;
        this.carElement.style["left"] = this.x + 'px';
      };

      Car.prototype.moveUp = function (step) {
        this.y -= step ? step : this.speed;
        this.carElement.style["top"] = this.y + 'px';
      };

      Car.prototype.moveDown = function (step) {
        this.y += step ? step : this.speed;
        this.carElement.style["top"] = this.y + 'px';
      };

      let addedCar = new Car(0, 200, 50);
      let addedCar2 = new Car(0, 300, 10);

      document.getElementById('carRacingBtnUp').addEventListener('click', function () {
        addedCar.moveUp(Math.ceil(Math.random() * addedCar.speed));
      }, false);

      document.getElementById('carRacingBtnDown').addEventListener('click', function () {
        addedCar.moveDown(Math.ceil(Math.random() * addedCar.speed));
      }, false);

      document.getElementById('carRacingBtnLeft').addEventListener('click', function () {
        addedCar.moveLeft(Math.ceil(Math.random() * addedCar.speed));
      }, false);

      document.getElementById('carRacingBtnRight').addEventListener('click', function () {
        addedCar.moveRight(Math.ceil(Math.random() * addedCar.speed));
      }, false);

      document.getElementById('carRacingBtnRun').addEventListener('click', function () {
        let animationRacing = setInterval(function () {
          addedCar.moveRight(Math.ceil(Math.random() * 5));
          addedCar2.moveRight(Math.ceil(Math.random() * 5));
        }, 30);
      }, false);
    };

    // Рисование на Canvas
    let canvasDraw = function canvasDraw() {
      let cnvs = document.getElementById('canvasDrawContainer');
      let ctx = cnvs.getContext('2d');

      //--- Рисование человечка
      let drawMan = function drawMan() {
        ctx.clearRect(0, 0, cnvs.width, cnvs.height);

        ctx.fillRect(100,100,50,50);
        ctx.fillStyle = "Yellow";
        ctx.fillRect(120,150,10,20);
        ctx.fillStyle = "Blue";
        ctx.fillRect(60,170,130,10);
        ctx.fillStyle = "Green";
        ctx.fillRect(90,180,70,60);
        ctx.fillStyle = "Gray";
        ctx.fillRect(90,240,10,50);
        ctx.fillStyle = "Gold";
        ctx.fillRect(150,240,10,50);

        ctx.strokeStyle = "Red";
        ctx.lineWidth = "2";
        ctx.strokeRect(300,300,30,30);
        ctx.beginPath();
        ctx.moveTo(315,331);
        ctx.lineTo(315,391);
        ctx.moveTo(315,351);
        ctx.lineTo(290,341);
        ctx.moveTo(315,351);
        ctx.lineTo(340,341);
        ctx.moveTo(315,391);
        ctx.lineTo(290,421);
        ctx.moveTo(315,391);
        ctx.lineTo(340,421);
        ctx.stroke();
      };

      //--- Рисование снеговика
      let drawSnowman = function drawSnowman() {
        let circle = function circle(x, y, radius, lineWidth, color, isFill) {
          ctx.lineWidth = lineWidth;
          isFill ? ctx.fillStyle = color: ctx.strokeStyle = color;
          ctx.beginPath();
          ctx.arc(x, y, radius, 0, Math.PI * 2, false);
          isFill ? ctx.fill() : ctx.stroke();
        };

        let position = prompt("Где должен появится снеговик? (например, 50,50)", "100,100");
        let [positionX, positionY] = position.split(',');
        
        positionX = parseFloat(positionX, 10);
        positionY = parseFloat(positionY, 10);

        ctx.clearRect(0, 0, cnvs.width, cnvs.height);

        circle(positionX, positionY, 30, 2, 'Black', false);
        circle(positionX, positionY + 80, 50, 2, 'Black', false);
        circle(positionX - 10, positionY - 10, 5, 0, 'Black', true);
        circle(positionX + 10, positionY - 10, 5, 0, 'Black', true);
        circle(positionX, positionY + 5, 5, 0, 'Orange', true);
        circle(positionX, positionY + 55, 6, 0, 'Black', true);
        circle(positionX, positionY + 80, 6, 0, 'Black', true);
        circle(positionX, positionY + 105, 6, 0, 'Black', true);
      };

      //--- Рисование по массиву точек
      let drawPoints = function drawPoints() {
        let points = prompt('Введите последовательность точек в виде: X1,Y1:X2,Y2 и т. д.', '50,50:200,200:50,200:50,50');

        if (points.length === 0) {
          return;
        }

        let lineW = prompt('Толщина линии', '2');
        let color = prompt('Цвет линии', 'Black');
        let pointsArray = points.split(':');
        let firstPoint = pointsArray[0].split(',');

        ctx.lineWidth = lineW;
        ctx.strokeStyle = color;

        ctx.clearRect(0, 0, cnvs.width, cnvs.height);

        ctx.beginPath();
        ctx.moveTo(parseFloat(firstPoint[0], 10),parseFloat(firstPoint[1], 10));

        for (let i = 1; i < pointsArray.length; i++) {
          let coords = pointsArray[i].split(',');
          ctx.lineTo(parseFloat(coords[0], 10),parseFloat(coords[1], 10));
        }

        ctx.stroke();
      };

      //--- Рисование кругов при клике
      let drawCircleClick = function drawCircleClick() {
        ctx.clearRect(0, 0, cnvs.width, cnvs.height);

        cnvs.addEventListener('click', function (e) {
          ctx.fillStyle = "rgba(" + Math.floor(Math.random() * 256) + ", " + Math.floor(Math.random() * 256) + ", " + Math.floor(Math.random() * 256) + ", " + Math.random() + ")";
          ctx.beginPath();
          ctx.arc(e.offsetX, e.offsetY, Math.floor(Math.random() * 50), 0, Math.PI * 2, false);
          ctx.fill();
        }, false);
      };

      return {
        drawMan: drawMan,
        drawSnowman: drawSnowman,
        drawPoints: drawPoints,
        drawCircleClick: drawCircleClick
      };
    };

    // Инициализация кода после загрузки контента
    window.addEventListener('DOMContentLoaded', function () {
      const ARRAY_BTNS = [
        'ball',
        'generatedInsult',
        'generatedPassword',
        'toHackLang',
        'startGameViselica',
        'arraysСompareBtn',
        'findInMapBtn',
        'drawManBtn',
        'drawSnowmanBtn',
        'drawPointsBtn',
        'drawCircleClickBtn'
      ];

      const ARRAY_FUNCTIONS = [
        initBall,
        generateInsult,
        generatePassword,
        hackLang,
        gameViselica,
        arraysСompare,
        findInMap,
        canvasDraw().drawMan,
        canvasDraw().drawSnowman,
        canvasDraw().drawPoints,
        canvasDraw().drawCircleClick
      ];

      if (ARRAY_BTNS.length !== ARRAY_FUNCTIONS.length) {
        alert('Неверное соотношение количества кнопок и функций');
        return;
      }

      for (var k = 0; k < ARRAY_BTNS.length; k++) {
        addEventButton(ARRAY_BTNS[k], ARRAY_FUNCTIONS[k]);
      }

      carRacing();
    }, false);

  </script>
  <body>

    <table border="0" cellpadding="0" cellspacing="0">
      <tr>
        <td><button type="button" id="ball">Шар Судьбы</button></td>
        <td colspan="3"><div id="resultPhraseBall"></div></td>
      </tr>
      <tr>
        <td><button type="button" id="generatedInsult">Генератор дразнилок</button></td>
        <td colspan="3"><div id="resultInsult"></div></td>
      </tr>
      <tr>
        <td rowspan="2"><button type="button" id="generatedPassword">Генератор пароля</button></td>
        <td>
          <label for="selectAlpabetUpper">
            <input id="selectAlpabetUpper" type="checkbox" name="selectAlpabetUpper">
            Добавить заглавные буквы
          </label>
        </td>
        <td>
          <label for="selectDigitals">
            <input id="selectDigitals" type="checkbox" name="selectDigitals">
            Добавить цифры
          </label>
        </td>
        <td>
          <label for="selectSymbols">
            <input id="selectSymbols" type="checkbox" name="selectSymbols">
            Добавить символы
          </label>
        </td>
      </tr>
      <tr>
        <td colspan="3"><div id="resultPassword">&nbsp;</div></td>
      </tr>
      <tr>
        <td><button type="button" id="toHackLang">Хакерский язык</button></td>
        <td colspan="3"><div id="resultHack"></div></td>
      </tr>
      <tr>
        <td rowspan="2"><button type="button" id="startGameViselica">Игра Виселица</button></td>
        <td colspan="3"><canvas width="500" height="300" id="viselicaCanvas"></td>
      </tr>
      <tr>
        <td colspan="3"><div id="viselicaWord">&nbsp;</div></td>
      </tr>
      <tr>
        <td><button type="button" id="arraysСompareBtn">Сравнение массивов</button></td>
        <td colspan="3"><div id="arraysСompareResult"></div></td>
      </tr>
      <tr>
        <td rowspan="2"><button type="button" id="findInMapBtn">Найти клад!</button></td>
        <td colspan="3">
          <img width="500" height="500" id="findInMapImg" src="http://nostarch.com/images/treasuremap.png">
        </td>
      </tr>
      <tr>
        <td colspan="3"><div id="findInMapResult">&nbsp;</div></td>
      </tr>
      <tr>
        <td>
          <button type="button" id="carRacingBtnUp">Ехать вверх</button>
          <br><br>
          <button type="button" id="carRacingBtnDown">Ехать вниз</button>
          <br><br>
          <button type="button" id="carRacingBtnLeft">Ехать влево</button>
          <br><br>
          <button type="button" id="carRacingBtnRight">Ехать вправо</button>
          <br><br>
          <button type="button" id="carRacingBtnRun">Гонка!</button>
        </td>
        <td colspan="3"><div id="carRacingRoad"></div></td>
      </tr>
      <tr> 
        <td>
          <button type="button" id="drawManBtn">Нарисовать человечков</button>
          <br><br>
          <button type="button" id="drawSnowmanBtn">Нарисовать снеговика</button>
          <br><br>
          <button type="button" id="drawPointsBtn">Нарисовать по точкам</button>
          <br><br>
          <button type="button" id="drawCircleClickBtn">Рисовать круги при клике мышью</button>
        </td>
        <td colspan="3"><canvas width="500" height="500" id="canvasDrawContainer"></canvas></td>
      </tr>
    </table>

  </body>
</html>
